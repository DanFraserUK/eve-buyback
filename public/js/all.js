function initManageItems(e){var a=$("#manage-form-items").DataTable({dom:"lBfrtip",ajax:e.actions.getItems,sAjaxDataProp:"",columns:[{data:null,defaultContent:"",className:"select-checkbox",orderable:!1},{data:"type.typeName",render:function(e,a,t,s){return"display"!=a?e:'<img src="https://image.eveonline.com/Type/'+t.typeID+'_32.png"> '+e}},{data:"type.group.groupName"},{data:"type.group.category.categoryName"},{data:"buyRaw",render:function(e,a,t,s){return"display"!=a?e:1==e?'<span class="fa fa-fw fa-check-square-o"></span>':'<span class="fa fa-fw fa-square-o"></span>'}},{data:"buyRecycled",render:function(e,a,t,s){return"display"!=a?e:1==e?'<span class="fa fa-fw fa-check-square-o"></span>':'<span class="fa fa-fw fa-square-o"></span>'}},{data:"buyRefined",render:function(e,a,t,s){return"display"!=a?e:1==e?'<span class="fa fa-fw fa-check-square-o"></span>':'<span class="fa fa-fw fa-square-o"></span>'}},{data:"buyModifier",render:function(e,a,t,s){return"display"!=a?e:e.toFixed(2)}},{data:"buyPrice",render:function(e,a,t,s){return"display"!=a?e:e.toFixed(2).replace(/(\d)(?=(\d{3})+(?!\d))/g,"$1,")+" ISK"}},{data:"sell",render:function(e,a,t,s){return"display"!=a?e:1==e?'<span class="fa fa-fw fa-check-square-o"></span>':'<span class="fa fa-fw fa-square-o"></span>'}},{data:"sellModifier",render:function(e,a,t,s){return"display"!=a?e:e.toFixed(2)}},{data:"sellPrice",render:function(e,a,t,s){return"display"!=a?e:e.toFixed(2).replace(/(\d)(?=(\d{3})+(?!\d))/g,"$1,")+" ISK"}},{data:"lockPrices",render:function(e,a,t,s){return"display"!=a?e:1==e?'<span class="fa fa-fw fa-check-square-o"></span>':'<span class="fa fa-fw fa-square-o"></span>'}}],select:{style:"multi",selector:"td:first-child"},buttons:["selectAll","selectNone",{text:e.trans.buyback.config.items.add,action:function(a,t,s,l){var c='<div class="row">	<div class="col-md-12">		<form id="manage-form-add-items" class="form-horizontal" action="'+e.actions.addItems+'" method="POST">			<input type="hidden" name="_token" value="'+e.token+'">			<div class="form-group">				<label class="col-md-4 control-label">'+e.trans.buyback.config.items.item_2+'</label>				<div class="col-md-8">					<select id="types" name="types[]" class="form-control" multiple="multiple"></select>				</div>			</div>			<div class="form-group">				<label class="col-md-4 control-label">'+e.trans.buyback.config.items.group_2+'</label>				<div class="col-md-8">					<select id="groups" name="groups[]" class="form-control" multiple="multiple"></select>				</div>			</div>			<div class="form-group">				<label class="col-md-4 control-label">'+e.trans.buyback.config.items.category_2+'</label>				<div class="col-md-8">					<select id="categories" name="categories[]" class="form-control" multiple="multiple"></select>				</div>			</div>			<div class="form-group">				<label class="col-md-4 control-label">'+e.trans.buyback.config.items.buy_settings+'</label>				<div class="col-md-8">					<div class="checkbox"><label><input type="checkbox" name="buyRaw"     >'+e.trans.buyback.config.items.buy_raw_help_2+'</label></div>					<div class="checkbox"><label><input type="checkbox" name="buyRecycled">'+e.trans.buyback.config.items.buy_recycled_help_2+'</label></div>					<div class="checkbox"><label><input type="checkbox" name="buyRefined" >'+e.trans.buyback.config.items.buy_refined_help_2+'</label></div>				</div>			</div>			<div class="form-group">				<label class="col-md-4 control-label">'+e.trans.buyback.config.items.buy_modifier+'</label>				<div class="col-md-8">					<input class="form-control" type="number" name="buyModifier" min="0" step="0.01" value="">				</div>			</div>			<div class="form-group">				<label class="col-md-4 control-label">'+e.trans.buyback.config.items.sell_settings+'</label>				<div class="col-md-8">					<div class="checkbox"><label><input type="checkbox" name="sell">'+e.trans.buyback.config.items.sell_help_2+'</label></div>				</div>			</div>			<div class="form-group">				<label class="col-md-4 control-label">'+e.trans.buyback.config.items.sell_modifier+'</label>				<div class="col-md-8">					<input class="form-control" type="number" name="sellModifier" min="0" step="0.01" value="">				</div>			</div>			<div class="form-group">				<label class="col-md-4 control-label">'+e.trans.buyback.config.items.item_settings+'</label>				<div class="col-md-8">					<div class="checkbox"><label><input type="checkbox" name="lockPrices">'+e.trans.buyback.config.items.lock_prices_help+"</label></div>				</div>			</div>		</form>	</div></div>",n=bootbox.dialog({message:c,title:e.trans.buyback.config.items.add_items,buttons:{cancel:{label:e.trans.buyback.config.items.cancel,className:"btn-default",callback:function(){}},update:{label:e.trans.buyback.config.items.add,className:"btn-success",callback:function(){var e=$("#manage-form-add-items"),a=e.attr("action");$.post(a,e.serialize(),function(e){1==e.result?($.notify(e.message,{className:"success"}),t.ajax.reload()):$.notify(e.message,{className:"error"})})}}}});n.bind("shown.bs.modal",function(){$("#manage-form-add-items #types").select2({ajax:{url:e.actions.getTypes,dataType:"json",delay:250,minimumInputLength:3,data:function(e){return{query:e.term,page:e.page}},processResults:function(e,a){return a.page=a.page||1,$.map(e.data,function(e){e.id=e.typeID,e.text=e.typeName}),{results:e.data,pagination:{more:20*a.page<e.total}}},cache:!0},templateResult:function(e){return e.id?$('<span><img src="https://image.eveonline.com/Type/'+e.typeID+'_32.png"> '+e.typeName+"</span>"):e.text}}),$("#manage-form-add-items #groups").select2({ajax:{url:e.actions.getGroups,dataType:"json",delay:250,minimumInputLength:3,data:function(e){return{query:e.term,page:e.page}},processResults:function(e,a){return a.page=a.page||1,$.map(e.data,function(e){e.id=e.groupID,e.text=e.groupName}),{results:e.data,pagination:{more:20*a.page<e.total}}},cache:!0},templateResult:function(e){return e.id?$("<span>"+e.groupName+"</span>"):e.text}}),$("#manage-form-add-items #categories").select2({ajax:{url:e.actions.getCategories,dataType:"json",delay:250,minimumInputLength:3,data:function(e){return{query:e.term,page:e.page}},processResults:function(e,a){return a.page=a.page||1,$.map(e.data,function(e){e.id=e.categoryID,e.text=e.categoryName}),{results:e.data,pagination:{more:20*a.page<e.total}}},cache:!0},templateResult:function(e){return e.id?$("<span>"+e.categoryName+"</span>"):e.text}})}),t.ajax.reload()},enabled:!0},{text:e.trans.buyback.config.items.edit,action:function(t,s,l,c){var n=a.rows(".selected").data(),i="";$.each(n,function(e,a){i+=a.typeID+","}),i=i.substr(0,i.length-1);var o=1==n.count()?e.trans.buyback.config.items.update_item_1:e.trans.buyback.config.items.update_item_2,r='<div class="row">	<div class="col-md-12">		<form id="manage-form-update-items" class="form-horizontal" action="'+e.actions.updateItems+'" method="POST">			<input type="hidden" name="_token" value="'+e.token+'">			<input type="hidden" name="items" value="'+i+'">			<div class="form-group">				<label class="col-md-4 control-label">'+e.trans.buyback.config.items.buy_settings+'</label>				<div class="col-md-8">					<div class="checkbox"><label><input type="checkbox" name="buyRaw"     '+(n[0].buyRaw?" checked":"")+">"+(1==n.count()?e.trans.buyback.config.items.buy_raw_help_1:e.trans.buyback.config.items.buy_raw_help_2)+'</label></div>					<div class="checkbox"><label><input type="checkbox" name="buyRecycled"'+(n[0].buyRecycled?" checked":"")+">"+(1==n.count()?e.trans.buyback.config.items.buy_recycled_help_1:e.trans.buyback.config.items.buy_recycled_help_2)+'</label></div>					<div class="checkbox"><label><input type="checkbox" name="buyRefined" '+(n[0].buyRefined?" checked":"")+">"+(1==n.count()?e.trans.buyback.config.items.buy_refined_help_1:e.trans.buyback.config.items.buy_refined_help_2)+'</label></div>				</div>			</div>			<div class="form-group">				<label class="col-md-4 control-label">'+e.trans.buyback.config.items.buy_modifier+'</label>				<div class="col-md-8">					<input class="form-control" type="number" name="buyModifier" min="0" step="0.01" value="'+n[0].buyModifier+'">				</div>			</div>'+(1==n.count()?'			<div class="form-group">				<label class="col-md-4 control-label">'+e.trans.buyback.config.items.buy_price+'</label>				<div class="col-md-8">					<input class="form-control" type="number" name="buyPrice" min="0" value="'+n[0].buyPrice+'">				</div>			</div>':"")+'			<div class="form-group">				<label class="col-md-4 control-label">'+e.trans.buyback.config.items.sell_settings+'</label>				<div class="col-md-8">					<div class="checkbox"><label><input type="checkbox" name="sell"'+(n[0].sell?" checked":"")+">"+(1==n.count()?e.trans.buyback.config.items.sell_help_1:e.trans.buyback.config.items.sell_help_2)+'</label></div>				</div>			</div>			<div class="form-group">				<label class="col-md-4 control-label">'+e.trans.buyback.config.items.sell_modifier+'</label>				<div class="col-md-8">					<input class="form-control" type="number" name="sellModifier" min="0" step="0.01" value="'+n[0].sellModifier+'">				</div>			</div>'+(1==n.count()?'			<div class="form-group">				<label class="col-md-4 control-label">'+e.trans.buyback.config.items.sell_price+'</label>				<div class="col-md-8">					<input class="form-control" type="number" name="sellPrice" min="0" value="'+n[0].sellPrice+'">				</div>			</div>':"")+'			<div class="form-group">				<label class="col-md-4 control-label">'+e.trans.buyback.config.items.item_settings+'</label>				<div class="col-md-8">					<div class="checkbox"><label><input type="checkbox" name="lockPrices"'+(n[0].lockPrices?" checked":"")+">"+e.trans.buyback.config.items.lock_prices_help+"</label></div>				</div>			</div>		</form>	</div></div>";bootbox.dialog({message:r,title:o,buttons:{cancel:{label:e.trans.buyback.config.items.cancel,className:"btn-default",callback:function(){}},update:{label:e.trans.buyback.config.items.update,className:"btn-success",callback:function(){var e=$("#manage-form-update-items"),a=e.attr("action");$.post(a,e.serialize(),function(e){1==e.result?($.notify(e.message,{className:"success"}),s.ajax.reload()):$.notify(e.message,{className:"error"})})}}}})}},{text:e.trans.buyback.config.items.remove,action:function(t,s,l,c){var n=a.rows({selected:!0}),i=1==n.count()?e.trans.buyback.config.items.confirm_remove_1:e.trans.buyback.config.items.confirm_remove_2,o=1==n.count()?e.trans.buyback.config.items.remove_item_1:e.trans.buyback.config.items.remove_item_2;bootbox.dialog({message:i,title:o,buttons:{cancel:{label:e.trans.buyback.config.items.cancel,className:"btn-default",callback:function(){}},remove:{label:e.trans.buyback.config.items.remove,className:"btn-danger",callback:function(){}}}})},enabled:!1},{text:e.trans.buyback.config.items.update_prices,action:function(e,a,t,s){a.ajax.reload()},enabled:!0}]});$(".dt-buttons").addClass("btn-group"),$(".dt-button").addClass("btn btn-default"),$(".dt-button").removeClass("dt-button");var t=function(e,t,s,l){var c=a.rows({selected:!0}).count();a.button(3).enable(c>=1),a.button(4).enable(c>=1)};a.on("select",t),a.on("deselect",t),a.on("draw",t)}$(document).ready(function(){String.prototype.format||(String.prototype.format=function(){var e=arguments;return this.replace(/{(\d+)}/g,function(a,t){return"undefined"!=typeof e[t]?e[t]:a})})}),$("#manage-form-motd").submit(function(){var e=$("#manage-form-motd #submit");return e.attr("disabled",!0),$.post($(this).attr("action"),$(this).serialize(),function(a){e.attr("disabled",!1),1==a.result?$.notify(a.message,{className:"success"}):$.notify(a.message,{className:"error"})}),!1});