function collect(){for(var e={},a=arguments.length,t=0;a>t;t++)for(p in arguments[t])arguments[t].hasOwnProperty(p)&&(e[p]=arguments[t][p]);return e}function initIndexSelling(){function e(){total=0,$(".sell-subtotal").each(function(e){subtotal=parseFloat($(this).html()),subtotal=isNaN(subtotal)?0:subtotal,total+=subtotal}),$("#sell-total").html(total.toFixed(2))}$(".sell-control").on("input",function(){quantity=parseInt($(this).val()),quantity=isNaN(quantity)?0:quantity,price=$(this).data("price"),$("#sell-subtotal-"+$(this).data("typeid")).html((quantity*price).toFixed(2)),e()})}function initManageMotd(e){var a=$("#manage-form-motd");a.submit(function(){var t=$("#manage-form-motd #submit");return t.prop("disabled",!0),t.html('<span class="fa fa-spinner fa-spin"></span> '+e.trans.buttons.edit),$.ajax({type:"POST",url:e.actions.editMotd,data:a.serialize(),success:function(a){$.notify(a.message,{className:"success"}),t.prop("disabled",!1),t.html(e.trans.buttons.edit)},error:function(a,s,l){var n=JSON.parse(a.responseText);$.notify(n.message,{className:"error"}),t.prop("disabled",!1),t.html(e.trans.buttons.edit)}}),!1})}function initManageItems(e){var a=$("#manage-form-items").DataTable({dom:"lBfrtip",ajax:e.actions.getItems,sAjaxDataProp:"",columns:[{data:null,defaultContent:"",className:"select-checkbox",orderable:!1},{data:"type.typeName",render:function(e,a,t,s){return"display"!=a?e:'<img src="https://image.eveonline.com/Type/'+t.typeID+'_32.png"> '+e}},{data:"type.group.groupName"},{data:"type.group.category.categoryName"},{data:"buyRaw",render:function(e,a,t,s){return"display"!=a?e:1==e?'<span class="fa fa-fw fa-check-square-o"></span>':'<span class="fa fa-fw fa-square-o"></span>'}},{data:"buyRecycled",render:function(e,a,t,s){return"display"!=a?e:1==e?'<span class="fa fa-fw fa-check-square-o"></span>':'<span class="fa fa-fw fa-square-o"></span>'}},{data:"buyRefined",render:function(e,a,t,s){return"display"!=a?e:1==e?'<span class="fa fa-fw fa-check-square-o"></span>':'<span class="fa fa-fw fa-square-o"></span>'}},{data:"buyModifier",render:function(e,a,t,s){return"display"!=a?e:e.toFixed(2)}},{data:"buyPrice",render:function(e,a,t,s){return"display"!=a?e:e.toFixed(2).replace(/(\d)(?=(\d{3})+(?!\d))/g,"$1,")+" ISK"}},{data:"sell",render:function(e,a,t,s){return"display"!=a?e:1==e?'<span class="fa fa-fw fa-check-square-o"></span>':'<span class="fa fa-fw fa-square-o"></span>'}},{data:"sellModifier",render:function(e,a,t,s){return"display"!=a?e:e.toFixed(2)}},{data:"sellPrice",render:function(e,a,t,s){return"display"!=a?e:e.toFixed(2).replace(/(\d)(?=(\d{3})+(?!\d))/g,"$1,")+" ISK"}},{data:"lockPrices",render:function(e,a,t,s){return"display"!=a?e:1==e?'<span class="fa fa-fw fa-check-square-o"></span>':'<span class="fa fa-fw fa-square-o"></span>'}}],select:{style:"multi",selector:"td:first-child"},buttons:["selectAll","selectNone",{text:e.trans.buttons.add,action:function(t,s,l,n){var o='<div class="row">	<div class="col-md-12">		<form id="manage-form-add-items" class="form-horizontal">			<input type="hidden" name="_token" value="'+e.token+'">			<div class="form-group">				<label class="col-md-4 control-label">'+e.trans.headers.types.split("|")[1]+'</label>				<div class="col-md-8">					<select id="types" name="types[]" class="form-control" multiple="multiple"></select>				</div>			</div>			<div class="form-group">				<label class="col-md-4 control-label">'+e.trans.headers.groups.split("|")[1]+'</label>				<div class="col-md-8">					<select id="groups" name="groups[]" class="form-control" multiple="multiple"></select>				</div>			</div>			<div class="form-group">				<label class="col-md-4 control-label">'+e.trans.headers.categories.split("|")[1]+'</label>				<div class="col-md-8">					<select id="categories" name="categories[]" class="form-control" multiple="multiple"></select>				</div>			</div>			<div class="form-group">				<label class="col-md-4 control-label">'+e.trans.headers.buy_settings+'</label>				<div class="col-md-8">					<div class="checkbox"><label><input type="checkbox" name="buyRaw"     >'+e.trans.messages.buy_raw.split("|")[1]+'</label></div>					<div class="checkbox"><label><input type="checkbox" name="buyRecycled">'+e.trans.messages.buy_recycled.split("|")[1]+'</label></div>					<div class="checkbox"><label><input type="checkbox" name="buyRefined" >'+e.trans.messages.buy_refined.split("|")[1]+'</label></div>				</div>			</div>			<div class="form-group">				<label class="col-md-4 control-label">'+e.trans.headers.buy_modifier+'</label>				<div class="col-md-8">					<input class="form-control" type="number" name="buyModifier" min="0" step="0.01" value="">				</div>			</div>			<div class="form-group">				<label class="col-md-4 control-label">'+e.trans.headers.sell_settings+'</label>				<div class="col-md-8">					<div class="checkbox"><label><input type="checkbox" name="sell">'+e.trans.messages.sell_items.split("|")[1]+'</label></div>				</div>			</div>			<div class="form-group">				<label class="col-md-4 control-label">'+e.trans.headers.sell_modifier+'</label>				<div class="col-md-8">					<input class="form-control" type="number" name="sellModifier" min="0" step="0.01" value="">				</div>			</div>			<div class="form-group">				<label class="col-md-4 control-label">'+e.trans.headers.item_settings+'</label>				<div class="col-md-8">					<div class="checkbox"><label><input type="checkbox" name="lockPrices">'+e.trans.messages.lock_prices+"</label></div>				</div>			</div>		</form>	</div></div>",r=bootbox.dialog({message:o,title:e.trans.messages.add_items.split("|")[1],buttons:{cancel:{label:e.trans.buttons.cancel,className:"btn-default",callback:function(){}},update:{label:e.trans.buttons.add,className:"btn-success",callback:function(){var t=$("#manage-form-add-items"),l=a.button(2);l.enable(!1),l.text('<span class="fa fa-spinner fa-spin"></span> '+e.trans.buttons.add),$.ajax({type:"POST",url:e.actions.addItems,data:t.serialize(),success:function(a){$.notify(a.message,{className:"success"}),l.enable(!0),l.text(e.trans.buttons.add),s.ajax.reload()},error:function(a,t,n){var o=JSON.parse(a.responseText);$.notify(o.message,{className:"error"}),l.enable(!0),l.text(e.trans.buttons.add),s.ajax.reload()}})}}}});r.bind("shown.bs.modal",function(){$("#manage-form-add-items #types").select2({ajax:{url:e.actions.getTypes,dataType:"json",delay:250,minimumInputLength:3,data:function(e){return{query:e.term,page:e.page}},processResults:function(e,a){return a.page=a.page||1,$.map(e.data,function(e){e.id=e.typeID,e.text=e.typeName}),{results:e.data,pagination:{more:20*a.page<e.total}}},cache:!0},templateResult:function(e){return e.id?$('<span><img src="https://image.eveonline.com/Type/'+e.typeID+'_32.png"> '+e.typeName+"</span>"):e.text}}),$("#manage-form-add-items #groups").select2({ajax:{url:e.actions.getGroups,dataType:"json",delay:250,minimumInputLength:3,data:function(e){return{query:e.term,page:e.page}},processResults:function(e,a){return a.page=a.page||1,$.map(e.data,function(e){e.id=e.groupID,e.text=e.groupName}),{results:e.data,pagination:{more:20*a.page<e.total}}},cache:!0},templateResult:function(e){return e.id?$("<span>"+e.groupName+"</span>"):e.text}}),$("#manage-form-add-items #categories").select2({ajax:{url:e.actions.getCategories,dataType:"json",delay:250,minimumInputLength:3,data:function(e){return{query:e.term,page:e.page}},processResults:function(e,a){return a.page=a.page||1,$.map(e.data,function(e){e.id=e.categoryID,e.text=e.categoryName}),{results:e.data,pagination:{more:20*a.page<e.total}}},cache:!0},templateResult:function(e){return e.id?$("<span>"+e.categoryName+"</span>"):e.text}})}),s.ajax.reload()},enabled:!0},{text:e.trans.buttons.edit,action:function(t,s,l,n){var o=a.rows(".selected").data(),r="";$.each(o,function(e,a){r+=a.typeID+","}),r=r.substr(0,r.length-1);var c=e.trans.messages.edit_items.split("|")[1==o.count()?0:1],i='<div class="row">	<div class="col-md-12">		<form id="manage-form-update-items" class="form-horizontal" action="'+e.actions.editItems+'" method="POST">			<input type="hidden" name="_token" value="'+e.token+'">			<input type="hidden" name="items" value="'+r+'">			<div class="form-group">				<label class="col-md-4 control-label">'+e.trans.headers.buy_settings+'</label>				<div class="col-md-8">					<div class="checkbox"><label><input type="checkbox" name="buyRaw"     '+(o[0].buyRaw?" checked":"")+">"+e.trans.messages.buy_raw.split("|")[1==o.count()?0:1]+'</label></div>					<div class="checkbox"><label><input type="checkbox" name="buyRecycled"'+(o[0].buyRecycled?" checked":"")+">"+e.trans.messages.buy_recycled.split("|")[1==o.count()?0:1]+'</label></div>					<div class="checkbox"><label><input type="checkbox" name="buyRefined" '+(o[0].buyRefined?" checked":"")+">"+e.trans.messages.buy_refined.split("|")[1==o.count()?0:1]+'</label></div>				</div>			</div>			<div class="form-group">				<label class="col-md-4 control-label">'+e.trans.headers.buy_modifier+'</label>				<div class="col-md-8">					<input class="form-control" type="number" name="buyModifier" min="0" step="0.01" value="'+o[0].buyModifier+'">				</div>			</div>'+(1==o.count()?'			<div class="form-group">				<label class="col-md-4 control-label">'+e.trans.headers.buy_price+'</label>				<div class="col-md-8">					<input class="form-control" type="number" name="buyPrice" min="0" value="'+o[0].buyPrice+'">				</div>			</div>':"")+'			<div class="form-group">				<label class="col-md-4 control-label">'+e.trans.headers.sell_settings+'</label>				<div class="col-md-8">					<div class="checkbox"><label><input type="checkbox" name="sell"'+(o[0].sell?" checked":"")+">"+e.trans.messages.sell_items.split("|")[1]+'</label></div>				</div>			</div>			<div class="form-group">				<label class="col-md-4 control-label">'+e.trans.headers.sell_modifier+'</label>				<div class="col-md-8">					<input class="form-control" type="number" name="sellModifier" min="0" step="0.01" value="'+o[0].sellModifier+'">				</div>			</div>'+(1==o.count()?'			<div class="form-group">				<label class="col-md-4 control-label">'+e.trans.headers.sell_price+'</label>				<div class="col-md-8">					<input class="form-control" type="number" name="sellPrice" min="0" value="'+o[0].sellPrice+'">				</div>			</div>':"")+'			<div class="form-group">				<label class="col-md-4 control-label">'+e.trans.headers.item_settings+'</label>				<div class="col-md-8">					<div class="checkbox"><label><input type="checkbox" name="lockPrices"'+(o[0].lockPrices?" checked":"")+">"+e.trans.messages.lock_prices+"</label></div>				</div>			</div>		</form>	</div></div>";bootbox.dialog({message:i,title:c,buttons:{cancel:{label:e.trans.buttons.cancel,className:"btn-default",callback:function(){}},update:{label:e.trans.buttons.edit,className:"btn-success",callback:function(){var t=$("#manage-form-update-items"),l=a.button(3);l.enable(!1),l.text('<span class="fa fa-spinner fa-spin"></span> '+e.trans.buttons.edit),$.ajax({type:"POST",url:e.actions.editItems,data:t.serialize(),success:function(a){$.notify(a.message,{className:"success"}),l.enable(!0),l.text(e.trans.buttons.edit),s.ajax.reload()},error:function(a,t,n){var o=JSON.parse(a.responseText);$.notify(o.message,{className:"error"}),l.enable(!0),l.text(e.trans.buttons.edit),s.ajax.reload()}})}}}})},enabled:!0},{text:e.trans.buttons.remove,action:function(t,s,l,n){var o=a.rows(".selected").data(),r="";$.each(o,function(e,a){r+=a.typeID+","}),r=r.substr(0,r.length-1);var c=e.trans.messages.remove_items_confirm.split("|")[1==o.count()?0:1],i=e.trans.messages.remove_items.split("|")[1==o.count()?0:1];bootbox.dialog({message:c,title:i,buttons:{cancel:{label:e.trans.buttons.cancel,className:"btn-default",callback:function(){}},remove:{label:e.trans.buttons.remove,className:"btn-danger",callback:function(){var t=a.button(4);t.enable(!1),t.text('<span class="fa fa-spinner fa-spin"></span> '+e.trans.buttons.remove),$.ajax({type:"POST",url:e.actions.removeItems,data:{_token:e.token,types:r},success:function(a){$.notify(a.message,{className:"success"}),t.enable(!0),t.text(e.trans.buttons.remove),s.ajax.reload()},error:function(a,l,n){var o=JSON.parse(a.responseText);$.notify(o.message,{className:"error"}),t.enable(!0),t.text(e.trans.buttons.remove),s.ajax.reload()}})}}}})},enabled:!1},{text:e.trans.buttons.update_prices,action:function(t,s,l,n){var o=a.button(5);o.enable(!1),o.text('<span class="fa fa-spinner fa-spin"></span> '+e.trans.buttons.update_prices),$.ajax({type:"POST",url:e.actions.updateItems,data:{_token:e.token},success:function(a){$.notify(a.message,{className:"success"}),o.enable(!0),o.text(e.trans.buttons.update_prices),s.ajax.reload()},error:function(a,t,l){var n=JSON.parse(a.responseText);$.notify(n.message,{className:"error"}),o.enable(!0),o.text(e.trans.buttons.update_prices),s.ajax.reload()}})},enabled:!0}]});$(".dt-buttons").addClass("btn-group"),$(".dt-button").addClass("btn btn-default"),$(".dt-button").removeClass("dt-button");var t=function(e,t,s,l){var n=a.rows({selected:!0}).count();a.button(3).enable(n>=1),a.button(4).enable(n>=1)};a.on("select",t),a.on("deselect",t),a.on("draw",t)}$(document).ready(function(){String.prototype.format||(String.prototype.format=function(){var e=arguments;return this.replace(/{(\d+)}/g,function(a,t){return"undefined"!=typeof e[t]?e[t]:a})})}),document.onkeydown=function(e){if(e=e||window.event,e.ctrlKey&&86==e.keyCode){var a=document.getElementById("pasteDataTextBox");a.focus(),setTimeout(function(){form=document.getElementById("pasteForm"),form.submit()},500)}};